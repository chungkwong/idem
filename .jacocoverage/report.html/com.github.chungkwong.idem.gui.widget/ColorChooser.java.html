<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="zh"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>ColorChooser.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JaCoCoverage analysis of project &quot;MIDE&quot; (powered by JaCoCo from EclEmma)</a> &gt; <a href="index.source.html" class="el_package">com.github.chungkwong.idem.gui.widget</a> &gt; <span class="el_source">ColorChooser.java</span></div><h1>ColorChooser.java</h1><pre class="source lang-java linenums">package com.github.chungkwong.idem.gui.widget;
import static com.github.chungkwong.idem.global.Log.LOG;
import java.awt.*;
import java.awt.event.*;
import java.io.*;
import javax.imageio.*;
import javax.swing.*;
import javax.swing.colorchooser.*;
import static com.github.chungkwong.idem.global.UILanguageManager.*;
import java.util.logging.*;

public final class ColorChooser extends JColorChooser implements Chooser&lt;Color&gt;{
	//JColorChooser chooser=new JColorChooser();
<span class="nc" id="L14">	public ColorChooser(){</span>
<span class="nc" id="L15">		addChooserPanel(new ColorPicker(this));</span>
<span class="nc" id="L16">	}</span>
	public ColorChooser(Color color){
<span class="nc" id="L18">		this();</span>
<span class="nc" id="L19">		setColor(color);</span>
<span class="nc" id="L20">	}</span>
	public void showDialog(){
<span class="nc" id="L22">		JColorChooser.createDialog(null,getDefaultTranslation(&quot;PICK_COLOR&quot;),false,this,null,null).setVisible(true);</span>
<span class="nc" id="L23">	}</span>
	public JComponent getComponent(){
<span class="nc" id="L25">		return this;</span>
	}
	@Override
	public Color getValue(){
<span class="nc" id="L29">		return getColor();</span>
	}
	public static void main(String[] args) throws Exception{
<span class="nc" id="L32">		JFrame f=new JFrame(&quot;Console&quot;);</span>
<span class="nc" id="L33">		f.add(new ColorChooser(),BorderLayout.CENTER);//the use of SwingConsole can be so simple</span>
<span class="nc" id="L34">		f.setExtendedState(JFrame.MAXIMIZED_BOTH);</span>
<span class="nc" id="L35">		f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span>
<span class="nc" id="L36">		f.setVisible(true);</span>
<span class="nc" id="L37">		new ColorChooser().showDialog();</span>
<span class="nc" id="L38">	}</span>
}
class ColorPicker extends AbstractColorChooserPanel{
<span class="nc" id="L41">	JLabel screenshot=new JLabel();</span>
	Robot robot;
	ColorChooser chooser;
<span class="nc" id="L44">	ColorPicker(ColorChooser chooser){</span>
<span class="nc" id="L45">		this.chooser=chooser;</span>
<span class="nc" id="L46">	}</span>
	protected void buildChooser(){
		try{
<span class="nc" id="L49">			robot=new Robot();</span>
<span class="nc" id="L50">		}catch(Exception ex){</span>
<span class="nc" id="L51">			LOG.log(Level.WARNING,null,ex);</span>
<span class="nc" id="L52">		}</span>
<span class="nc" id="L53">		setLayout(new BorderLayout());</span>
<span class="nc" id="L54">		Box tool=Box.createHorizontalBox();</span>
<span class="nc" id="L55">		tool.add(new JLabel(getDefaultTranslation(&quot;PICK_COLOR_BELOW&quot;)));</span>
<span class="nc" id="L56">		JButton refresh=new JButton(getDefaultTranslation(&quot;CAPTURE&quot;));</span>
		//captureScreen();
<span class="nc" id="L58">		refresh.addActionListener((e)-&gt;captureScreen());</span>
<span class="nc" id="L59">		tool.add(refresh);</span>
<span class="nc" id="L60">		JButton load=new JButton(getDefaultTranslation(&quot;IMAGE&quot;));</span>
<span class="nc" id="L61">		load.addActionListener((e)-&gt;readImage());</span>
<span class="nc" id="L62">		tool.add(load);</span>
<span class="nc" id="L63">		add(tool,BorderLayout.NORTH);</span>
<span class="nc" id="L64">		screenshot.setCursor(Cursor.getPredefinedCursor(Cursor.CROSSHAIR_CURSOR));</span>
<span class="nc" id="L65">		screenshot.addMouseListener(new MouseAdapter(){</span>
			public void mouseClicked(MouseEvent e){
<span class="nc" id="L67">				getColorSelectionModel().setSelectedColor(robot.getPixelColor(e.getXOnScreen(),e.getYOnScreen()));</span>
<span class="nc" id="L68">			}</span>
		});
<span class="nc" id="L70">		add(new JScrollPane(screenshot),BorderLayout.CENTER);</span>
<span class="nc" id="L71">	}</span>
	void captureScreen(){
		try{
<span class="nc" id="L74">			loadImage(robot.createScreenCapture(new Rectangle(Toolkit.getDefaultToolkit().getScreenSize())));</span>
<span class="nc" id="L75">		}catch(Exception ex){</span>
<span class="nc" id="L76">			LOG.log(Level.WARNING,null,ex);</span>
<span class="nc" id="L77">		}</span>
<span class="nc" id="L78">	}</span>
	void readImage(){
<span class="nc" id="L80">		JFileChooser jfc=new JFileChooser();</span>
<span class="nc bnc" id="L81" title="All 2 branches missed.">		if(jfc.showOpenDialog(null)==JFileChooser.APPROVE_OPTION)</span>
<span class="nc" id="L82">			readImage(jfc.getSelectedFile());</span>
<span class="nc" id="L83">	}</span>
	void readImage(File file){
		try{
<span class="nc" id="L86">			loadImage(ImageIO.read(file));</span>
<span class="nc" id="L87">		}catch(Exception ex){</span>
<span class="nc" id="L88">			LOG.log(Level.WARNING,null,ex);</span>
<span class="nc" id="L89">		}</span>
<span class="nc" id="L90">	}</span>
	void loadImage(Image image){
<span class="nc" id="L92">		screenshot.setIcon(new ImageIcon(image));</span>
		//chooser.repaint();
<span class="nc" id="L94">	}</span>
	public Dimension getPreferredSize(){
<span class="nc" id="L96">		return new Dimension(chooser.getWidth()/2,chooser.getHeight()/2);//XXX</span>
	}
	public String getDisplayName(){
<span class="nc" id="L99">		return getDefaultTranslation(&quot;PICK_COLOR_FROM_SCREEN&quot;);</span>
	}
	public Icon getLargeDisplayIcon(){
<span class="nc" id="L102">		return null;</span>
	}
	public Icon getSmallDisplayIcon(){
<span class="nc" id="L105">		return null;</span>
	}
	public void updateChooser(){

<span class="nc" id="L109">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>